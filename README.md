# ä¼ä¸šçº§é‚®ä»¶æ”¶å‘ç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ä¼ä¸šçº§é‚®ä»¶æ”¶å‘ç³»ç»Ÿï¼Œæ”¯æŒå¤šåŸŸåå’Œå¤šåˆ«åç®¡ç†ï¼Œç±»ä¼¼äº Poste.io çš„åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ” ç”¨æˆ·ç®¡ç†
- ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- JWT èº«ä»½è®¤è¯
- ç”¨æˆ·æƒé™ç®¡ç†ï¼ˆç®¡ç†å‘˜/æ™®é€šç”¨æˆ·ï¼‰
- å¯†ç ä¿®æ”¹å’Œé‡ç½®

### ğŸ“§ é‚®ä»¶ç®¡ç†
- å¤šåŸŸåæ”¯æŒ
- æ¯ä¸ªè´¦æˆ·æ”¯æŒå¤šä¸ªé‚®ç®±åˆ«å
- é‚®ä»¶æ”¶å‘åŠŸèƒ½
- å¯Œæ–‡æœ¬é‚®ä»¶ç¼–è¾‘å™¨
- é™„ä»¶ä¸Šä¼ å’Œä¸‹è½½
- é‚®ä»¶æ–‡ä»¶å¤¹ç®¡ç†ï¼ˆæ”¶ä»¶ç®±ã€å·²å‘é€ã€è‰ç¨¿ç®±ç­‰ï¼‰
- é‚®ä»¶æœç´¢å’Œè¿‡æ»¤
- é‚®ä»¶æ‰¹é‡æ“ä½œ

### ğŸ‘¥ åˆ«åç®¡ç†
- åˆ›å»ºå’Œåˆ é™¤é‚®ç®±åˆ«å
- åˆ«åçŠ¶æ€ç®¡ç†
- åˆ«åé‚®ä»¶ç»Ÿè®¡
- åˆ«åé—´åˆ‡æ¢æŸ¥çœ‹é‚®ä»¶

### ğŸŒ åŸŸåç®¡ç†
- å¤šåŸŸåæ”¯æŒ
- åŸŸåçŠ¶æ€ç®¡ç†
- åŸŸåç»Ÿè®¡ä¿¡æ¯

### âš™ï¸ ç³»ç»Ÿç®¡ç†
- ç®¡ç†å‘˜æ§åˆ¶å°
- ç³»ç»ŸçŠ¶æ€ç›‘æ§
- é‚®ä»¶è‡ªåŠ¨åŒæ­¥
- å®šæ—¶ä»»åŠ¡è°ƒåº¦
- æ—¥å¿—ç®¡ç†

## æŠ€æœ¯æ ˆ

### åç«¯
- **Node.js** + **Express.js** - æœåŠ¡å™¨æ¡†æ¶
- **MySQL** - æ•°æ®åº“
- **JWT** - èº«ä»½è®¤è¯
- **Nodemailer** - é‚®ä»¶å‘é€
- **IMAP** - é‚®ä»¶æ¥æ”¶
- **Multer** - æ–‡ä»¶ä¸Šä¼ 
- **Winston** - æ—¥å¿—ç®¡ç†
- **Node-cron** - å®šæ—¶ä»»åŠ¡

### å‰ç«¯
- **React 18** - ç”¨æˆ·ç•Œé¢æ¡†æ¶
- **Ant Design** - UI ç»„ä»¶åº“
- **React Router** - è·¯ç”±ç®¡ç†
- **React Query** - æ•°æ®è·å–å’Œç¼“å­˜
- **Styled Components** - æ ·å¼ç®¡ç†
- **React Quill** - å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
- **Axios** - HTTP å®¢æˆ·ç«¯

## é¡¹ç›®ç»“æ„

```
email-system/
â”œâ”€â”€ server.js                 # ä¸»æœåŠ¡å™¨æ–‡ä»¶
â”œâ”€â”€ package.json              # åç«¯ä¾èµ–é…ç½®
â”œâ”€â”€ .env.example              # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ config/
â”‚   â””â”€â”€ database.js           # æ•°æ®åº“é…ç½®
â”œâ”€â”€ database/
â”‚   â””â”€â”€ schema.sql            # æ•°æ®åº“æ¶æ„
â”œâ”€â”€ routes/                   # APIè·¯ç”±
â”‚   â”œâ”€â”€ auth.js              # è®¤è¯è·¯ç”±
â”‚   â”œâ”€â”€ users.js             # ç”¨æˆ·ç®¡ç†è·¯ç”±
â”‚   â”œâ”€â”€ domains.js           # åŸŸåç®¡ç†è·¯ç”±
â”‚   â”œâ”€â”€ aliases.js           # åˆ«åç®¡ç†è·¯ç”±
â”‚   â”œâ”€â”€ emails.js            # é‚®ä»¶è·¯ç”±
â”‚   â””â”€â”€ system.js            # ç³»ç»Ÿç®¡ç†è·¯ç”±
â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ auth.js              # è®¤è¯å·¥å…·
â”‚   â”œâ”€â”€ email.js             # é‚®ä»¶å·¥å…·
â”‚   â”œâ”€â”€ logger.js            # æ—¥å¿—å·¥å…·
â”‚   â””â”€â”€ scheduler.js         # å®šæ—¶ä»»åŠ¡
â”œâ”€â”€ logs/                    # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ uploads/                 # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â””â”€â”€ client/                  # Reactå‰ç«¯é¡¹ç›®
    â”œâ”€â”€ package.json         # å‰ç«¯ä¾èµ–é…ç½®
    â”œâ”€â”€ public/
    â”‚   â””â”€â”€ index.html       # HTMLæ¨¡æ¿
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ components/      # Reactç»„ä»¶
    â”‚   â”œâ”€â”€ pages/           # é¡µé¢ç»„ä»¶
    â”‚   â”œâ”€â”€ contexts/        # React Context
    â”‚   â”œâ”€â”€ services/        # APIæœåŠ¡
    â”‚   â”œâ”€â”€ App.js           # ä¸»åº”ç”¨ç»„ä»¶
    â”‚   â””â”€â”€ index.js         # åº”ç”¨å…¥å£
    â””â”€â”€ build/               # ç”Ÿäº§æ„å»ºç›®å½•
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 16+
- MySQL 8.0+
- SMTP/IMAPé‚®ä»¶æœåŠ¡å™¨

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd email-system
```

### 2. å®‰è£…ä¾èµ–
```bash
# å®‰è£…åç«¯å’Œå‰ç«¯ä¾èµ–
npm run install:all

# æˆ–åˆ†åˆ«å®‰è£…
npm install
cd client && npm install
```

### 3. é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
vim .env
```

å…³é”®é…ç½®é¡¹ï¼š
```bash
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_NAME=email_system
DB_USER=your_username
DB_PASSWORD=your_password

# JWTé…ç½®
JWT_SECRET=your_super_secret_jwt_key

# é‚®ä»¶æœåŠ¡å™¨é…ç½®
SMTP_HOST=your.smtp.server
SMTP_PORT=587
SMTP_USER=your_smtp_user
SMTP_PASS=your_smtp_password

IMAP_HOST=your.imap.server
IMAP_PORT=993
IMAP_USER=your_imap_user
IMAP_PASS=your_imap_password
```

### 4. åˆå§‹åŒ–æ•°æ®åº“
```bash
# åˆ›å»ºæ•°æ®åº“
mysql -u root -p -e "CREATE DATABASE email_system CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

# å¯¼å…¥æ•°æ®åº“æ¶æ„
mysql -u your_username -p email_system < database/schema.sql
```

### 5. å¯åŠ¨åº”ç”¨

#### å¼€å‘æ¨¡å¼
```bash
# åŒæ—¶å¯åŠ¨åç«¯å’Œå‰ç«¯
npm run dev:all

# æˆ–åˆ†åˆ«å¯åŠ¨
npm run dev        # åç«¯æœåŠ¡ (ç«¯å£ 3001)
npm run client     # å‰ç«¯æœåŠ¡ (ç«¯å£ 3000)
```

#### ç”Ÿäº§æ¨¡å¼
```bash
# æ„å»ºå‰ç«¯
npm run client:build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm start
```

### 6. è®¿é—®åº”ç”¨
- å‰ç«¯åœ°å€ï¼šhttp://localhost:3000
- åç«¯APIï¼šhttp://localhost:3001/api
- å¥åº·æ£€æŸ¥ï¼šhttp://localhost:3001/api/health

## ä½¿ç”¨è¯´æ˜

### ç®¡ç†å‘˜æ“ä½œ

1. **åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·**
   - æ³¨å†Œç¬¬ä¸€ä¸ªè´¦æˆ·åï¼Œæ‰‹åŠ¨åœ¨æ•°æ®åº“ä¸­å°†è¯¥ç”¨æˆ·çš„ `is_admin` å­—æ®µè®¾ç½®ä¸º `TRUE`
   - æˆ–é€šè¿‡ç¯å¢ƒå˜é‡ `ADMIN_EMAIL` é…ç½®ç®¡ç†å‘˜é‚®ç®±

2. **åŸŸåç®¡ç†**
   - ç™»å½•ç®¡ç†å‘˜æ§åˆ¶å°
   - æ·»åŠ é‚®ä»¶åŸŸåï¼ˆå¦‚ï¼šcompany.comï¼‰
   - é…ç½®DNSè®°å½•æŒ‡å‘é‚®ä»¶æœåŠ¡å™¨

3. **ç”¨æˆ·ç®¡ç†**
   - æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·
   - å¯ç”¨/ç¦ç”¨ç”¨æˆ·è´¦æˆ·
   - é‡ç½®ç”¨æˆ·å¯†ç 
   - æˆäºˆç®¡ç†å‘˜æƒé™

### ç”¨æˆ·æ“ä½œ

1. **åˆ›å»ºåˆ«å**
   - ç™»å½•ç³»ç»Ÿ
   - è¿›å…¥"åˆ«åç®¡ç†"
   - é€‰æ‹©åŸŸååˆ›å»ºé‚®ç®±åˆ«åï¼ˆå¦‚ï¼šjohn@company.comï¼‰

2. **æ”¶å‘é‚®ä»¶**
   - é€‰æ‹©åˆ«åæŸ¥çœ‹é‚®ä»¶
   - åœ¨ä¸åŒåˆ«åé—´åˆ‡æ¢
   - å‘é€é‚®ä»¶æ”¯æŒå¯Œæ–‡æœ¬å’Œé™„ä»¶
   - ä½¿ç”¨æ–‡ä»¶å¤¹ç®¡ç†é‚®ä»¶

3. **é‚®ä»¶æ“ä½œ**
   - æ ‡è®°å·²è¯»/æœªè¯»
   - æ·»åŠ æ˜Ÿæ ‡
   - ç§»åŠ¨åˆ°æ–‡ä»¶å¤¹
   - æ‰¹é‡æ“ä½œé‚®ä»¶

## APIæ–‡æ¡£

### è®¤è¯ç›¸å…³
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `GET /api/auth/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- `POST /api/auth/logout` - ç”¨æˆ·ç™»å‡º

### åˆ«åç®¡ç†
- `GET /api/aliases/my` - è·å–å½“å‰ç”¨æˆ·åˆ«å
- `POST /api/aliases` - åˆ›å»ºåˆ«å
- `PATCH /api/aliases/:id` - æ›´æ–°åˆ«å
- `DELETE /api/aliases/:id` - åˆ é™¤åˆ«å

### é‚®ä»¶ç®¡ç†
- `GET /api/emails/alias/:aliasId` - è·å–åˆ«åé‚®ä»¶åˆ—è¡¨
- `GET /api/emails/:id` - è·å–é‚®ä»¶è¯¦æƒ…
- `POST /api/emails/send` - å‘é€é‚®ä»¶
- `PATCH /api/emails/batch` - æ‰¹é‡æ“ä½œé‚®ä»¶

### ç®¡ç†å‘˜åŠŸèƒ½
- `GET /api/users` - è·å–ç”¨æˆ·åˆ—è¡¨
- `GET /api/domains` - è·å–åŸŸååˆ—è¡¨
- `POST /api/domains` - åˆ›å»ºåŸŸå
- `POST /api/system/sync-emails` - æ‰‹åŠ¨åŒæ­¥é‚®ä»¶

## å®‰å…¨ç‰¹æ€§

- JWTèº«ä»½è®¤è¯
- å¯†ç å“ˆå¸Œå­˜å‚¨ï¼ˆbcryptï¼‰
- SQLæ³¨å…¥é˜²æŠ¤
- XSSé˜²æŠ¤
- CSRFé˜²æŠ¤
- æ–‡ä»¶ä¸Šä¼ å®‰å…¨æ£€æŸ¥
- è¯·æ±‚é¢‘ç‡é™åˆ¶
- è¾“å…¥æ•°æ®éªŒè¯

## éƒ¨ç½²å»ºè®®

### ä½¿ç”¨Dockeréƒ¨ç½²
```dockerfile
# Dockerfileç¤ºä¾‹
FROM node:16-alpine

WORKDIR /app
COPY package*.json ./
RUN npm install --production

COPY . .
WORKDIR /app/client
RUN npm install && npm run build

WORKDIR /app
EXPOSE 3001
CMD ["npm", "start"]
```

### ä½¿ç”¨PM2éƒ¨ç½²
```bash
# å®‰è£…PM2
npm install -g pm2

# å¯åŠ¨åº”ç”¨
pm2 start server.js --name "email-system"
pm2 startup
pm2 save
```

### Nginxé…ç½®
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

## ç»´æŠ¤å’Œç›‘æ§

### æ—¥å¿—ç®¡ç†
- åº”ç”¨æ—¥å¿—ï¼š`logs/combined.log`
- é”™è¯¯æ—¥å¿—ï¼š`logs/error.log`
- æ—¥å¿—è½®è½¬ï¼šè‡ªåŠ¨ç®¡ç†æ—¥å¿—æ–‡ä»¶å¤§å°

### å®šæ—¶ä»»åŠ¡
- é‚®ä»¶åŒæ­¥ï¼šæ¯5åˆ†é’Ÿæ‰§è¡Œ
- ä¼šè¯æ¸…ç†ï¼šæ¯å¤©å‡Œæ™¨2ç‚¹
- æ•°æ®åº“ä¼˜åŒ–ï¼šæ¯å‘¨æ—¥å‡Œæ™¨4ç‚¹

### ç›‘æ§æŒ‡æ ‡
- é‚®ä»¶æ”¶å‘é‡
- ç”¨æˆ·æ´»è·ƒåº¦
- ç³»ç»Ÿå“åº”æ—¶é—´
- é”™è¯¯ç‡ç»Ÿè®¡

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥æ•°æ®åº“æœåŠ¡æ˜¯å¦è¿è¡Œ
   - éªŒè¯è¿æ¥å‚æ•°
   - ç¡®è®¤ç”¨æˆ·æƒé™

2. **é‚®ä»¶å‘é€å¤±è´¥**
   - æ£€æŸ¥SMTPé…ç½®
   - éªŒè¯é‚®ä»¶æœåŠ¡å™¨è¿é€šæ€§
   - ç¡®è®¤è´¦æˆ·è®¤è¯ä¿¡æ¯

3. **é‚®ä»¶æ¥æ”¶å¼‚å¸¸**
   - æ£€æŸ¥IMAPé…ç½®
   - éªŒè¯é‚®ç®±å¯†ç 
   - ç¡®è®¤é˜²ç«å¢™è®¾ç½®

### è°ƒè¯•æ¨¡å¼
```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
NODE_ENV=development LOG_LEVEL=debug npm run dev
```

## è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. åˆ›å»ºPull Request

## è®¸å¯è¯

MIT License

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜è¯·æäº¤Issueæˆ–è”ç³»ç³»ç»Ÿç®¡ç†å‘˜ã€‚